<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>サンディクイズ</title>
  <style>
    body {
      font-family: 'Segoe UI', 'Hiragino Kaku Gothic ProN', sans-serif;
      padding: 20px;
      max-width: 600px;
      margin: auto;
      background: #f8f9fa;
    }
    h1 {
      text-align: center;
      color: #1e88e5;
      margin-bottom: 30px;
      font-size: 2.2em;
      font-weight: bold;
      letter-spacing: 0.05em;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
    }
    .question {
      font-size: 1.4em;
      margin-bottom: 20px;
      background-color: #ffffff;
      padding: 15px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      border-left: 5px solid #2196f3;
    }
    .options {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }
    .options button {
      cursor: pointer;
      font-size: 1.2em;
      padding: 12px 24px;
      border: none;
      border-radius: 6px;
      background: linear-gradient(to right, #64b5f6, #42a5f5);
      color: white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      transition: background 0.3s ease, transform 0.1s ease;
      width: 80%;
      max-width: 450px;
    }
    .options button:hover {
      background: linear-gradient(to right, #42a5f5, #2196f3);
      transform: scale(1.03);
    }
    .explanation {
      background: #e3f2fd;
      padding: 10px;
      margin-top: 15px;
      border-left: 4px solid #42a5f5;
      border-radius: 4px;
    }
    .correct {
      background: #66bb6a !important;
      color: white !important;
    }
    .incorrect {
      background: #ef5350 !important;
      color: white !important;
    }
    .score {
      margin-top: 10px;
      font-size: 1em;
      color: #333;
    }
    button {
      font-family: 'Segoe UI', 'Hiragino Kaku Gothic ProN', sans-serif;
      font-size: 1.2em;
      padding: 12px 24px;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
    }
    button:hover {
      transform: scale(1.05);
    }
  </style>
</head>
<body>
  <h1>サンディクイズ</h1>
  <div id="quiz"></div>
  <script>
    const quizEl = document.getElementById('quiz');
    let index = 0;
    let correctCount = 0;
    let totalAnswered = 0;
    let incorrectIndexes = [];

    const questions = [
      { question: "na asti → ______", options: ["naasti", "nāsti", "nāāsti"], answer: 1, explanation: "-a + a は ā に融合する。したがって b) nāsti が正解。" },
      { question: "sā api → ______", options: ["sāpi", "sāāpi", "saapi"], answer: 0, explanation: "-ā + a は ā に融合する。したがって a) sāpi が正解。" },
      { question: "asti iha → ______", options: ["astīha", "astiha", "astiīha"], answer: 0, explanation: "-i + ī は ī に融合。したがって a) astīha が正解。" },
      { question: "sādhu uktam → ______", options: ["sādhuuktam", "sādhūktam", "sādhvuktam"], answer: 1, explanation: "-u + u は ū に融合する。したがって b) sādhūktam が正解。" },
      { question: "kartṛ ṛju → ______", options: ["kartr̥ju", "kartṛṛju", "kartṝju"], answer: 2, explanation: "-ṛ + ṛ は ṝ に融合。したがって c) kartṝju が正解。" },
      { question: "tava icchā → ______", options: ["tavecchā", "tavaicchā", "tavicchā"], answer: 0, explanation: "-a + i は e に融合する。したがって a) tavecchā が正解。" },
      { question: "sā uktvā → ______", options: ["soktvā", "sāuktvā", "sāoktvā"], answer: 0, explanation: "-ā + u は o に融合する。したがって a) soktvā が正解。" },
      { question: "yathā ṛtu → ______", options: ["yathartu", "yathārṭu", "yatharitu"], answer: 0, explanation: "-ā + ṛ は ar に融合する。したがって a) yathartu が正解。" },
      { question: "tava eva → ______", options: ["tavaiva", "taveva", "tavāeva"], answer: 0, explanation: "-a + e は ai に融合する。したがって a) tavaiva が正解。" },
      { question: "tava aiśvaryam → ______", options: ["tavaaiśvaryam", "tavaiśvaryam", "tavāiśvaryam"], answer: 1, explanation: "-ā + ai は ai に保持される。したがって b) tavaiśvaryam が正解。" },
      { question: "sā oṣadhiḥ → ______", options: ["sauṣadhiḥ", "sāoṣadhiḥ", "sa oṣadhiḥ"], answer: 0, explanation: "-ā + o は au に融合する。したがって a) sauṣadhiḥ が正解。" },
      { question: "tasya autsukyam → ______", options: ["tasyautsukyam", "tasyaautsukyam", "tasyāoutsukyam"], answer: 0, explanation: "-ā + au は au に融合する。したがって a) tasyautsukyam が正解。" },
      { question: "nadī eva → ______", options: ["nadyeva", "nadīeva", "nadiveva"], answer: 0, explanation: "-ī + 母音 は y に半母音化。したがって a) nadyeva が正解。" },
      { question: "madhu iva → ______", options: ["madhviva", "madhuiva", "madhūiva"], answer: 0, explanation: "-ū + 母音 は v に半母音化。したがって a) madhviva が正解。" },
      { question: "kartṛ asti → ______", options: ["kartr asti", "kartṛasti", "kartra asti"], answer: 0, explanation: "-ṛ + 母音 は r に半母音化。したがって a) kartr asti が正解。" },
      { question: "te api → ______", options: ["teʼpi", "tepi", "te api"], answer: 0, explanation: "-e + a は a 脱落しアヴァグラハ（ʼ）で表記。したがって a) teʼpi が正解。" },
      { question: "prabho atra → ______", options: ["prabhoʼtra", "prabhoatra", "prabhātra"], answer: 0, explanation: "-o + a は a 脱落しアヴァグラハ。したがって a) prabhoʼtra が正解。" },
      { question: "tau ubhau api → ______", options: ["tāv ubhāv api", "tau ubhauapi", "tāubhāv api"], answer: 0, explanation: "この変化は2段階あります：1) tau → tāv は語形変化、2) ubhau + api は au + a の母音サンディで āv になります。したがって a) tāv ubhāv api が正解。" }
    ];
    

    function showQuestion() {
      const q = questions[index];
      quizEl.innerHTML = `
        <div class="question">Q${index + 1}: ${q.question}</div>
        <div class="options">
          ${q.options.map((opt, i) => `<button onclick="checkAnswer(${i})">${String.fromCharCode(97 + i)}) ${opt}</button>`).join('')}
        </div>
        <div id="explanation"></div>
        <div class="score" id="score"></div>
        <button onclick="nextQuestion()" style="margin-top:20px">次の問題</button>
      `;
    }

    function checkAnswer(selected) {
      const q = questions[index];
      const buttons = document.querySelectorAll('.options button');
      buttons.forEach((btn, i) => {
        btn.disabled = true;
        if (i === selected) {
          if (i === q.answer) {
            btn.classList.add('correct');
          } else {
            btn.classList.add('incorrect');
            incorrectIndexes.push(index);
          }
        } else if (i === q.answer) {
          btn.classList.add('correct');
        }
      });
      if (selected === q.answer) correctCount++;
      totalAnswered++;
      document.getElementById('explanation').innerHTML = `<div class="explanation">${q.explanation}</div>`;
      document.getElementById('score').textContent = `正解数: ${correctCount} / 解答数: ${totalAnswered}`;
    }

    function nextQuestion() {
      index++;
      if (index >= questions.length) {
        let percentage = correctCount / questions.length;
        let color = '#1e88e5';
        if (percentage >= 0.8) color = '#4caf50'; // 緑
        else if (percentage >= 0.4) color = '#ff9800'; // 黄
        else color = '#f44336'; // 赤

        quizEl.innerHTML = `
          <div style="text-align: center; margin-top: 50px;">
            <h2 style="font-size: 2em; color: ${color};">
              お疲れさまです。${questions.length}問中、${correctCount}問正解です！
            </h2>
            <div style="display: flex; flex-direction: column; align-items: center; gap: 15px; margin-top: 25px;">
              <button onclick="retryIncorrect()" style="padding: 14px 28px; font-size: 1.1em; background-color: #42a5f5; color: white; border: none; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.2);">間違った問題に挑戦</button>
              <button onclick="location.reload()" style="padding: 14px 28px; font-size: 1.1em; background-color: #9e9e9e; color: white; border: none; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.2);">もう一度挑戦</button>
            </div>
          </div>
        `;
      } else {
        showQuestion();
      }
    }

    function retryIncorrect() {
      if (incorrectIndexes.length === 0) {
        alert("間違った問題はありません。");
        return;
      }
      questions.splice(0, questions.length, ...incorrectIndexes.map(i => questions[i]));
      index = 0;
      correctCount = 0;
      totalAnswered = 0;
      incorrectIndexes = [];
      showQuestion();
    }

    showQuestion();
  </script>
</body>
</html>
